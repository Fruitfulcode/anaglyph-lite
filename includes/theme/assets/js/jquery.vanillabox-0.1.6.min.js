(function($){/*
 Vanillabox
 (C) 2013 cocopon.

 Licensed under the MIT license:
 http://www.opensource.org/licenses/mit-license.php
*/
var c;function h(){}function k(a,b){return void 0!==a?a:b}function l(a){function b(){}b.prototype=m.prototype;a.prototype=new b}function n(a,b){var d=a.length,e;for(e=0;e<d;e++)b.call(this,a[e],e)}function p(a,b){var d=[],e=a.length,f;for(f=0;f<e;f++)d.push(b.call(this,a[f],f));return d}function q(){var a=new $.Deferred;setTimeout(function(){a.resolve()},0);return a.promise()}function s(){return!!navigator.userAgent.match(/(ipod|iphone|ipad)/ig)};function t(){};var u={va:function(a){return a.a.show().promise()},ga:function(a){return a.a.hide()},ua:function(a){u.T(a);return a.a.show().promise()},fa:function(a){return a.a.hide()},T:function(a){var b=a.d,d=b.q(),e=v(a,d);b.a.css({width:d.width,height:d.height});a.a.css({left:e.left,top:e.top});return q()},ta:function(a){return a.a.show().promise()},ea:function(a){return a.a.hide().promise()}},w={va:function(a){return a.a.fadeIn(200).promise()},ga:function(a){return a.a.fadeOut(300).promise()},xa:function(a,
b,d,e){var f=a.d.a;f.stop();b=f.animate({width:b.width,height:b.height},e);a=a.a;a.stop();d=a.animate({left:d.left,top:d.top},e);return $.when(b,d)},ua:function(a){var b=a.d,d=b.q(),e=v(a,d);b.a.css({width:d.width,height:d.height});a.a.css({left:e.left,top:e.top});return q()},fa:function(){return q()},T:function(a){var b=a.d.q(),d=v(a,b);return w.xa(a,b,d,300)},ta:function(a){return a.a.fadeIn(200).promise()},ea:function(a){return a.a.fadeOut(300).promise()}};var x={none:u,"default":w};function z(){this.e()}c=z.prototype;c.e=function(){var a=$("<div>");a.addClass("vnbx-mask");this.a=a;this.g()};c.b=function(){this.h();this.a=null};c.g=function(){$(window).on("resize",$.proxy(this.I,this));this.a.on("click",$.proxy(this.o,this))};c.h=function(){$(window).off("resize",this.I);this.a.off("click",this.o)};c.C=function(){var a=this.a;a.width("");a.height("");var b=$(window),d=$(document),e=Math.max(d.width(),b.width()),b=Math.max(d.height(),b.height());a.width(e);a.height(b)};c.I=function(){this.C()};
c.o=function(){$(this).trigger("vnbx_click")};function A(a){a=a||{};this.m=k(a.w,w);this.l=k(a.u,"both");this.e()}c=A.prototype;c.e=function(){var a=$("<div>");a.addClass("vnbx-container");this.a=a;this.g()};c.b=function(){this.h();this.a=null};c.g=function(){};c.h=function(){this.B()};c.V=function(){$(this.c).on("vnbx_complete",$.proxy(this.F,this))};c.B=function(){var a=this.c;a&&$(a).off("vnbx_complete",this.F)};
function B(a,b){var d=a.m;if(b!==a.c){if(a.c){a.B();var e=a.c;d.ea(e).done(function(){a.S(e)})}a.c=b;if(a.c){a.V();a.ia&&C(a);var f=a.a,g=a.c.a,r=f.find("> *");0===r.length?f.append(g):g.insertBefore(r.first());d.ta(a.c).done(function(){$(a).trigger("vnbx_content_show",[a,a.c])})}}}c.q=function(){var a=this.c,b={width:0,height:0};a&&(b=a.q());return{width:Math.max(b.width,200),height:Math.max(b.height,150)}};
function D(a){a.ia={width:!0===a.l||"both"===a.l||"horizontal"===a.l?(window.innerWidth||document.documentElement.clientWidth)-100:Number.MAX_VALUE,height:!0===a.l||"both"===a.l||"vertical"===a.l?(window.innerHeight||document.documentElement.clientHeight)-100:Number.MAX_VALUE};a.c&&C(a)}function C(a){var b=a.ia;a.c.Z(Math.max(b.width,200),Math.max(b.height,150))}c.C=function(){var a=this.c,b=a.q();a.a.css({marginLeft:-Math.round(b.width/2),marginTop:-Math.round(b.height/2)})};c.F=function(){this.C()};
c.S=function(a){$(this).trigger("vnbx_content_hide",[this,a])};function E(a){a=a||{};this.d=new A({w:a.w,u:a.u});this.e();this.g()}c=E.prototype;c.e=function(){var a=$("<div>");a.addClass("vnbx-frame");this.a=a;this.a.append(this.d.a)};c.b=function(){this.d.b();this.d=null;this.h();this.a=null};c.g=function(){this.a.on("click",$.proxy(this.o,this))};c.h=function(){this.a.off("click",this.o)};
function v(a,b){var d=a.d.a,e=d.width(),f=d.height();d.width(b.width);d.height(b.height);var g=$(window),r=a.a,y=window.innerWidth||document.documentElement.clientWidth,U=window.innerHeight||document.documentElement.clientHeight,y=Math.round(g.scrollLeft()+(y-r.outerWidth())/2),g=Math.max(Math.round(g.scrollTop()+(U-r.outerHeight())/2),0);d.width(e);d.height(f);return{left:y,top:g}}c.o=function(a){a.stopPropagation()};function m(a){a=a||{};this.wa=this.R=!1;this.sa=a.path;this.Ha=k(a.title,"");this.e()}c=m.prototype;c.e=function(){var a=$("<div>");a.addClass("vnbx-content");this.a=a;this.$();this.g()};c.$=h;c.g=h;c.h=h;c.b=function(){this.h();this.a.remove();this.a=null};c.aa=function(){return!1};c.q=function(){var a=this.a;return{width:a.width(),height:a.height()}};c.Z=function(a,b){this.a.css({maxWidth:a,maxHeight:b})};c.load=function(){this.a.addClass("vnbx-loading");this.R?F(this,this.wa):this.X()};c.X=h;
c.unload=function(){this.da();this.R=!1};c.da=h;function F(a,b){var d=a.a;a.R=!0;a.wa=b;d.removeClass("vnbx-loading");b||d.addClass("vnbx-error");$(a).trigger("vnbx_complete",b)}function G(a){m.call(this,a)}l(G);G.prototype.e=function(){m.prototype.e.call(this);this.a.addClass("vnbx-empty")};G.prototype.load=function(){var a=this;setTimeout(function(){$(a).trigger("vnbx_complete",!0)},0)};function H(a){m.call(this,a)}l(H);c=H.prototype;c.$=function(){var a=$("<img>");this.a.append(a);this.r=a};
c.b=function(){m.prototype.b.call(this);this.r=null};c.g=function(){var a=this.r;a.on("load",$.proxy(this.H,this));a.on("error",$.proxy(this.G,this))};c.h=function(){var a=this.r;a.off("load",this.H);a.off("error",this.G)};c.Z=function(a,b){this.r.css({maxWidth:a,maxHeight:b})};c.X=function(){this.r.attr("src",this.sa)};c.da=function(){this.r.attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==")};
c.H=function(){"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="!==this.r.attr("src")&&F(this,!0)};c.G=function(){F(this,!1)};function I(a){a=a||{};this.Da=a.K;this.Ca=a.J;m.call(this,a)}l(I);c=I.prototype;c.$=function(){var a=$("<iframe>");a.attr("frameborder",0);this.a.append(a);this.j=a};c.b=function(){m.prototype.b.call(this);this.j=null};c.aa=function(){return!0};c.g=function(){var a=this.j;a.on("load",$.proxy(this.H,this));a.on("error",$.proxy(this.G,this))};
c.h=function(){var a=this.j;a.off("load",this.H);a.off("error",this.G)};c.q=function(){var a=s()?this.a:this.j;return{width:a.width(),height:a.height()}};c.Z=function(a,b){(s()?this.a:this.j).css({maxWidth:a,maxHeight:b})};c.X=function(){this.j.attr("src",this.sa)};c.da=function(){this.j.attr("src","about:blank");var a=s()?this.a:this.j;a.width("");a.height("")};c.H=function(){var a=this.j.attr("src");a&&"about:blank"!==a&&(a=s()?this.a:this.j,a.width(this.Da),a.height(this.Ca),F(this,!0))};
c.G=function(){F(this,!1)};var J={image:function(a){return new H({path:a.attr("href"),title:a.attr("title")})},iframe:function(a,b){return new I({path:a.attr("href"),K:b.K,J:b.J,title:a.attr("title")})}};function K(a){a=a||{};this.s=k(a.Ia,1);this.v=k(a.loop,!1);L(this,k(a.page,0))}function L(a,b){var d=a.i,e=a.s,e=Math.min(Math.max(b,0),e-1);a.i=e;d!==e&&$(a).trigger("vnbx_change")}K.prototype.next=function(){var a=this.s,b=this.i,d=b+1;d>a-1&&(d=this.v?0:a-1);this.i=d;b!==d&&$(this).trigger("vnbx_change")};K.prototype.M=function(){var a=this.s,b=this.i,d=b-1;0>d&&(d=this.v?a-1:0);this.i=d;b!==d&&$(this).trigger("vnbx_change")};function M(a){this.A=a.t;this.W=k(a.disabled,!1);this.e()}c=M.prototype;c.e=function(){var a=$("<div>");a.addClass("vnbx-button");this.A&&a.addClass(this.A);a.attr("ontouchstart","void(0)");this.a=a;this.g()};c.b=function(){this.a=null};c.g=function(){this.a.on("click",$.proxy(this.o,this))};c.h=function(){this.a.off("click",this.o)};function N(a,b){var d=a.a;a.W=b;a.W?d.addClass("vnbx-disabled"):d.removeClass("vnbx-disabled")}c.o=function(a){a.stopPropagation();this.W||$(this).trigger("vnbx_click")};function O(a){this.A=a.t;this.e()}O.prototype.e=function(){var a=$("<div>");a.addClass("vnbx-label");this.A&&a.addClass(this.A);this.a=a};O.prototype.b=function(){this.a=null};function P(a){if(!a.ba||0===a.ba.length)throw new t;this.U=!1;this.N=a.ba;this.m=k(a.w,w);this.Fa=a.Ea;this.Ga=a.Ba;this.O=a.ya;this.l=a.u;this.Q=a.Aa;this.za={K:a.K,J:a.J,type:a.type};this.k=new K({loop:a.loop,Ia:this.N.length});this.e()}c=P.prototype;
c.e=function(){var a=new z,b=a.a;b.addClass("vnbx");b.hide();$("body").append(b);this.n=a;a=this.n.a;s()&&a.addClass("vnbx-ios");this.O&&a.addClass("vnbx-close-button-enabled");this.Q&&1<this.k.s&&a.addClass("vnbx-group");var d=new E({w:this.m,u:this.l}),a=d.a;this.f=d;b.append(a);this.ca=b=new O({t:"vnbx-title"});a.append(b.a);this.Y=b=new O({t:"vnbx-pager"});a.append(b.a);this.L=b=new M({t:"vnbx-prev"});a.append(b.a);this.D=b=new M({t:"vnbx-next"});a.append(b.a);b=new M({t:"vnbx-close"});this.O||
b.a.hide();this.P=b;a.append(b.a);this.g();Q(this)};c.b=function(){R(this);this.h();S(this);this.ca.b();this.ca=null;this.Y.b();this.Y=null;this.P.b();this.P=null;this.L.b();this.L=null;this.D.b();this.D=null;this.f.b();this.f=null;this.n.a.remove();this.n.b();this.n=null};function Q(a){a.p=p(a.N,function(b){b=$(b);var e=a.za,f=J[e.type];if(!f)throw new t;return f(b,e)});var b=new G;T(a,b)}function S(a){B(a.f.d,null);a.p&&(n(a.p,function(a){a.b()}),a.p=null)}
c.g=function(){this.N.on("click",$.proxy(this.qa,this));$(this.n).on("vnbx_click",$.proxy(this.ma,this));$(this.f.d).on("vnbx_content_hide",$.proxy(this.S,this));$(this.k).on("vnbx_change",$.proxy(this.oa,this));$(this.P).on("vnbx_click",$.proxy(this.ja,this));$(this.L).on("vnbx_click",$.proxy(this.pa,this));$(this.D).on("vnbx_click",$.proxy(this.na,this))};
c.h=function(){this.N.off("click",this.qa);$(this.n).off("vnbx_click",this.ma);$(this.f.d).off("vnbx_content_hide",this.S);$(this.k).off("vnbx_change",this.oa);$(this.P).off("vnbx_click",this.ja);$(this.L).off("vnbx_click",this.pa);$(this.D).off("vnbx_click",this.na);this.B();this.c=null};function V(a){var b=$(window),d=$(document);b.on("resize",$.proxy(a.I,a));b.on("scroll",$.proxy(a.ra,a));d.on("keyup",$.proxy(a.la,a))}
function R(a){var b=$(window),d=$(document);b.off("resize",a.I,a);b.off("scroll",a.ra,a);d.off("keyup",a.la,a)}c.V=function(){var a=this.f.d.c;$(a).on("vnbx_complete",$.proxy(this.F,this));a.a.on("click",$.proxy(this.ka,this))};c.B=function(){var a=this.f.d.c;a&&($(a).off("complete",this.F),a.a.off("click",this.ka))};
c.show=function(a){var b=this,d=b.m;if(b.U)return q();b.U=!0;null===b.p&&Q(b);V(b);D(b.f.d);var e=b.n;e.C();var e=d.va(e),d=d.ua(b.f),f=b.k;a=k(a,0);var g=a!==f.i;L(f,a);g||W(b);return $.when(e,d).then(function(){$(b).trigger("vnbx_show")})};c.hide=function(){var a=this;return a.U?$.when(a.m.fa(a.f),a.m.ga(a.n)).then(function(){R(a);a.U=!1;n(a.p,function(a){a.aa()&&a.unload()});$(a).trigger("vnbx_hide")}):q()};c.M=function(){this.Q&&this.k.M()};c.next=function(){this.Q&&this.k.next()};
function T(a,b){var d=a.f.d,e=a.f.d.c;e&&e.R&&e===b||(a.B(),B(d,b),a.V(),a.ca.a.text(b.Ha),b.load());d.C()}function W(a){var b=a.k;a.Y.a.text(String(b.i+1)+" of "+String(b.s));N(a.L,!(b.v||0<b.i));N(a.D,!(b.v||b.i<b.s-1));T(a,a.p[a.k.i])}function X(a){a.ha&&clearTimeout(a.ha);a.ha=setTimeout(function(){a.Fa&&a.m.T(a.f)},300)}c.I=function(){X(this)};c.ra=function(){X(this)};c.la=function(a){if(this.Ga)switch(a.keyCode){case 27:this.hide();break;case 37:this.M();break;case 39:this.next()}};
c.qa=function(a){var b=this.N.index(a.delegateTarget);0>b||(a.preventDefault(),this.show(b))};c.oa=function(){W(this)};c.ma=function(){this.O||this.hide()};c.ja=function(){this.O&&this.hide()};c.pa=function(){this.M()};c.na=function(){this.next()};c.F=function(a,b){this.m.T(this.f);var d=a.target,e;a:{e=this.p;var f=e.length,g;for(g=0;g<f;g++)if(e[g]===d){e=g;break a}e=-1}0<=e&&$(this).trigger("vnbx_load",[b,d,e])};
c.ka=function(a){var b=this.k;a.stopPropagation();this.Q?b.v||b.i<b.s-1?this.next():this.hide():this.hide()};c.S=function(a,b,d){d.aa()&&d.unload()};var Y={animation:"default",closeButton:!1,adjustToWindow:"both",keyboard:!0,loop:!1,preferredHeight:600,preferredWidth:800,repositionOnScroll:!1,type:"image",grouping:!0};$.fn.Ja=function(a){var b={};$.extend(b,Y);$.extend(b,a);a=$(this);return new P({w:x[b.animation]||w,ya:b.closeButton,u:b.adjustToWindow,Ba:b.keyboard,loop:b.loop,J:b.preferredHeight,K:b.preferredWidth,Ea:b.repositionOnScroll,ba:a,type:b.type,Aa:b.grouping})};$.fn.vanillabox=$.fn.Ja;P.prototype.dispose=P.prototype.b;P.prototype.hide=P.prototype.hide;P.prototype.next=P.prototype.next;P.prototype.previous=P.prototype.M;P.prototype.show=P.prototype.show;})(jQuery);
